{% extends "layout.html" %}
{% block title %}
    Homepage
{% endblock %}

<script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
	integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
	crossorigin="anonymous">
</script>

<script src="js/jquery.endless-scroll.js"></script>

{% block main %}

    <style>
    body{
        background-color: #28262C;
    }

    #wrapper{
        background-color: white;
        border: solid 1px #eee;
        border-radius:10px; /* round corners */
        box-shadow:0px 3px 5px 5px #000; /* add shadow */
    }

    #button{

        float:left;
        margin-right:5px;
    }

    </style>


    <form><input type=button value="Refresh" onClick="window.location.reload()"></form>
    {% for image in images %}
        <div id="wrapper">
            {% if image.path.replace("'" , "")[:5] == 'https'  %}
                <img src="{{ url_for('getgif', gifje=image.path.split('/')[4])   }}" width="500" height="500"> <br>{{ image.description }}</br> <br> {{ image.username}} </br>
            {% else %}
                <img src="/static/img/{{ image.path }}" width="500" height="500"> <br>{{ image.description }}</br> <br> {{ image.username}} </br>
            {% endif %}

            <form action="{{ url_for('homepage') }}" method="post" onsubmit="return value">
                <input type="button" id="like{{ image.image_id }}" class="btn btn-danger btn-sm" value="{{ image.likes }}"><img src="/static/hart.png" width="50" height="50"></button>
            </form>

            <form action="{{ url_for('homepage') }}" method="post" onsubmit="return value">
                <button name="comment" class="btnclick btn-sm" value="{{ image.image_id }}"><img src="/static/comment.png" width="50" height="50"></button>
            </form>

            <div style="width: 300px; overflow: auto; overflow-x: hidden; height: 100px;">

            {% for comment in comments %}
                {% if comment.image_id == image.image_id %}
                    <h2>{{ comment.username }}</h2>
                    <p>{{ comment.comment }}</p>
                 {% endif %}
            {% endfor %}
            </div>
        </div>
        <br>


<script>
$("#like{{ image.image_id }}").click(function(){
    $.post("{{ url_for('like') }}",
    {
        image_id : "{{ image.image_id }}",
    },
    function(data, status){
        $("#like{{ image.image_id }}").prop('value', data);
    });
});

</script>

    {% endfor %}
{% endblock %}


